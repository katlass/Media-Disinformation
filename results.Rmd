# Results

```{r}
# install.packages("hexbin")
# install.packages('evaluate')
library(markdown)
library(rmarkdown)
library(haven)
library(tidyverse)
library(gridExtra)
# install.packages("wesanderson")
library(wesanderson)
# install.packages("hrbrthemes")
library(hrbrthemes) # for plot themes
library(ggplot2)
library(grid)
install.packages("gridtext")
library(gridtext)
dataset = as.data.frame(read_sav("/Users/renatorusso/Desktop/Ed.D./Fall-2022/GR5702/media_disinformation/fake_news_confirmation_bias_x2.sav"))

str(dataset)


```

```{r}
dataset$ideology <- haven::as_factor(dataset$ideology)
dataset$pol_party <- haven::as_factor(dataset$pol_party)
dataset$gender <- haven::as_factor(dataset$gender)
dataset$condition <- haven::as_factor(dataset$condition)
dataset %>%
  filter(gender == "female" | gender == "male")

#
# dataset %>%
#   filter(gender == "female" | gender == "male") %>%
#   ggplot() +
#   geom_mosaic(aes(x = product(ideology, pol_party), fill = gender))

c1 <- dataset %>%
  filter(gender == "female" | gender == "male") %>% 
  ggplot(aes(gender, fill = gender)) +
  geom_bar() +
  scale_fill_manual(
    values = c("#F3722C",
               "#43AA8B")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(title = "Gender of respondents") +
  ylab("Count") +
  xlab("") +
  theme(legend.position = "none") +
  scale_x_discrete(labels=c("female" = "Female",
                            "male" = "Male"))
  
c1


c2 <- ggplot(dataset, aes(pol_party, fill = pol_party), color = "white") +
  geom_bar() +
  scale_fill_manual(values=c("#277DA1",
                             "#F94144")) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(title = "Political affiliation") +
  ylab("Count") +
  xlab("") +
  theme(legend.position = "none") +
  scale_x_discrete(labels=c("democrat" = "Democrat",
                            "republican" = "Republican"))
  
c2

c3 <- ggplot(dataset, aes(ideology, fill = ideology), color = "white") +
  geom_bar() +
  scale_fill_manual(values = c("#277DA1",
                               "#8C9ACC",
                               "#BEA9E1",
                               "#EECDF1",
                               "#F58CAD",
                               "#FA6164",
                               "#F94144")) +
  theme_minimal()  +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(title = "Ideology") +
  ylab("Count") +
  xlab("") +
  theme(legend.position = "none") +
  scale_x_discrete(labels=c("1" = "Extremely\nliberal",
                            "2" = "",
                            "3" = "",
                            "4" = "Neutral",
                            "5" = "",
                            "6" = "",
                            "7" = "Extremely\nconservative"))
c3

c4 <- ggplot(dataset, aes(condition, fill = condition)) +
  geom_bar() +
  scale_fill_manual(values = c("#90BE6D",
                               "#F9844A")) +
  theme_minimal()  +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(title = "Experimental fact-checking condition") +
  ylab("Count") +
  xlab("") +
  theme(legend.position = "none") +
  scale_x_discrete(labels=c("easy" = "Easy",
                            "difficult" = "Difficult"))
c4

grid.arrange(c1, c2, c3, c4, nrow = 2,
             top = textGrob("Overview of respondents",
                            gp=gpar(fontsize=20)))


```
The charts above show that the sample is relatively balanced in terms of their political affiliation and ideology. About half of the sample identifies themselves as Democrats, half as Republicans. As for ideology, despite the difference in the extremes (the number of extremely liberals is about double that of extremely conservatives), the total numbers are rather similar at each side (124 to the left of neutral; 115 to the right of neutral).
As for gender, we can see a great gap between female and male respondents (166 x 178, respectively). Respondents who chose "other" or opted to not disclose their genders account for a total of 3 individuals, and are not shown in this chart (even if those categories were "topcoded", the height of the bars would be very low).
The researchers also achieved an important symmetry between the two experimental conditions of fact-checking: 125 were assigned to "easy;" 122 to "difficult").


#### Political Concordance vs Number of Fact-checks
```{r}
library(ggplot2)
library(gridExtra)
library(grid)

p1 <- ggplot(dataset,aes(x = t_concordant)) +
    geom_bar(data=subset(dataset, pol_party == 'democrat'), fill = "#277DA1", alpha = 0.8) +
    geom_bar(data=subset(dataset, pol_party == 'republican'), fill = "#F94144", alpha = 0.5) +
  ylab("Count") +
  labs(title = "True Concordant") +
  xlab("") +
  ylab("Count") +
  theme(legend.position = "top") +
  ylim(0, 35) +
  theme_minimal()
p1

p2 <- ggplot(dataset,aes(x = f_concordant)) +
    geom_bar(data=subset(dataset, pol_party == 'democrat'),fill = "#277DA1", alpha = 0.8) +
    geom_bar(data=subset(dataset, pol_party == 'republican'),fill = "#F94144", alpha = 0.5) +
  labs(title = "False Concordant") +
  xlab("") +
  ylab("") +
  ylim(0, 35) +
  theme_minimal()
p2

p3 <- ggplot(dataset,aes(x = t_discordant)) +
    geom_bar(data=subset(dataset, pol_party == 'democrat'),fill = "#277DA1", alpha = 0.8) +
    geom_bar(data=subset(dataset, pol_party == 'republican'),fill = "#F94144", alpha = 0.5) +
  labs(title = "True Discordant") +
  xlab("") +
  ylab("") +
  ylim(0, 35) +
  theme_minimal()
p3

p4 <- ggplot(dataset,aes(x = f_discordant)) +
    geom_bar(data=subset(dataset, pol_party == 'democrat'),fill = "#277DA1", alpha = 0.8) +
    geom_bar(data=subset(dataset, pol_party == 'republican'),fill = "#F94144", alpha = 0.5) +
  labs(title = "False Discordant") +
  xlab("") +
  ylab("") +
  ylim(0, 35) +
  theme_minimal()
p4

# Creating a common legend for the 4 plots
get_legend<-function(myggplot){ # source for this function: http://www.sthda.com/english/wiki/wiki.php?id_contents=7930
  tmp <- ggplot_gtable(ggplot_build(myggplot))
  leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
  legend <- tmp$grobs[[leg]]
  return(legend)
}


grid.arrange(p1, p2, p3, p4,
             ncol = 2,
             nrow = 2,
             top = textGrob("Political concordance and total number of fact-checks", gp=gpar(fontsize=20)),
             bottom = textGrob("Number of Fact-checks"))


```
The chart above shows the amount of fact-checks conducted by individuals according to their political affiliation: Republicans are in red, democrats are in blue, and the colors have a level of transparency (alpha). Each of the individual charts refers to concordance between the information presented and the individual's political perspective. Therefore, "True concordant" refers to information that is true and aligned with the respondent's political perspective; "False concordant" refers to information that is false and concordant with the individual's political perspective; the same logic applies to the other two categories.
This unified chart shows some patterns. For example, the number of republicans who perform 0 fact checks on true concordant news is higher than that of democrats. The opposite applies to democrats: more democrats perform 6 fact-checks to true concordant news. The same pattern is present in "false discordant" information.

#### Age vs Total Fact Checks by Ideology and Gender
```{r}
class(dataset$age)
class(dataset$total_fact_checks)
dataset$gender


class((dataset$ideology))
dataset %>%
  filter(gender == "male" | gender == "female") %>%
  ggplot(aes(x = age, y = total_fact_checks, color = ideology)) +
  geom_point() +
  facet_wrap("gender") +
  scale_color_manual(values = c("#277DA1",
                               "#8C9ACC",
                               "#BEA9E1",
                               "#EECDF1",
                               "#F58CAD",
                               "#FA6164",
                               "#F94144")) +
  theme_minimal()  +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(title = "Number of fact-checks by gender and ideology") +
  ylab("Total fact checks") +
  xlab("Age") +
  scale_x_discrete(labels=c("1" = "Extremely\nliberal",
                            "2" = "",
                            "3" = "",
                            "4" = "Neutral",
                            "5" = "",
                            "6" = "",
                            "7" = "Extremely\nconservative")) +
  scale_x_continuous(breaks = scales::pretty_breaks(n = 5))
  
```
The chart above shows that there are no salient trends in terms of fact-checking when comparing genders and ideologies.

#### Actively open-minded thinking and political affiliation
```{r}
dataset$AOT
class(dataset$AOT)

dataset %>%
  filter(gender == "female" | gender == "male") %>%
  ggplot(aes(x = pol_party, y = AOT, color = pol_party)) +
  geom_boxplot() +
  labs(title = "Actively open-minded thinking vs political party") +
  geom_jitter(size = 0.3, height = 0.2, width = 0.1) +
  facet_grid(~ gender) +
  theme_minimal()  +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(title = "Actively open-minded thinking vs political party and gender") +
  ylab("Actively open-minded thinking") +
  xlab("") +
  scale_x_discrete(labels=c("democrat" = "Democrat",
                            "republican" = "Republican")) +
  scale_color_manual(values=c("#277DA1",
                             "#F94144"))


```
The boxplots show the score for actively open-minded thinking -- "a general prescriptive theory that defines a standard or norm for all thinking, with emphasis on its role in the judgment of the thinking of others, and in maintaining appropriate confidence" (Baron, 2019). The chart shows that the most sensitive difference in that measure appears when comparing male participants across political affiliations: the median score for Democrat men is above the third quartile for Republican men. It is also noteworthy that all quartiles for Republican men are below those for Democrat men, although the minimum and maximum in one group are not so distant to the same measures in the other.
The same difference between quartiles also appear among women, and the median for female Democrats is very close to Republicans. 
The comparison between the same gender and across political parties does not show substantial differences.
It is important to note that the sample size for women is about double the size for men.


```{r}
ggplot(dataset, aes(x = CRT)) +
  geom_bar(aes(fill = pol_party))

library(vcd)
doubledecker(dataset$pol_party ~ dataset$CRT, data = dataset,
             gp = gpar(fill = c("#277DA1", "#F94144")))

```

The double decker chart shows the total number items responded correctly in the CRT scale ("Cognitive Reflection Test," Frederick, 2005). The width of "spines" in the chart points to a tendency of increase in size of the groups for higher numbers of correct answers. This is evident, for example, by the width of the spine for 6 correct answers. That is, when grouped by the number of correct answers, the largest segment is the one with participants who answered all questions correctly.
There is a fair amount of variance in terms of affiliaton to political parties across numbers of correct answers, except in the lower end, where Republicans prevail in this specific sample. Although no conclusive evidence can be drawn from this chart, Republicans are the largest group among those who answered only 0 and 1 questions correctly. The prevalent group varies considerably from 2 to 6 correct answers.

#### Reading time for true and false, concordant and discordant headlines according to political affiliation
```{r}
p1 <- ggplot(dataset,aes(x=T_dem_rt)) +
    geom_histogram(binwidth = 0.5, data=subset(dataset,pol_party == 'democrat'),fill = "#277DA1", alpha = 0.5) +
    geom_histogram(binwidth = 0.5, data=subset(dataset,pol_party == 'republican'),fill = "#F94144", alpha = 0.5) +
  ylab("Count") +
  xlab("True Pro-Liberal") +
  xlim(0, 30) +
  ylim(0, 80)
p1

p2 <- ggplot(dataset,aes(x=F_dem_rt)) +
    geom_histogram(binwidth = 0.5, data=subset(dataset,pol_party == 'democrat'),fill = "#277DA1", alpha = 0.5) +
    geom_histogram(binwidth = 0.5, data=subset(dataset,pol_party == 'republican'),fill = "#F94144", alpha = 0.5) +
  ylab("") +
  xlab("False Pro-Liberal") +
  xlim(0, 30) +
  ylim(0, 80)
p2

p3 <- ggplot(dataset,aes(x=T_rep_rt)) +
    geom_histogram(binwidth = 0.5, data=subset(dataset,pol_party == 'democrat'),fill = "#277DA1", alpha = 0.5) +
    geom_histogram(binwidth = 0.5, data=subset(dataset,pol_party == 'republican'),fill = "#F94144", alpha = 0.5) +
  ylab("") +
  xlab("True Pro-Conservative") +
  xlim(0, 30) +
  ylim(0, 80)
p3

p4 <- ggplot(dataset,aes(x=F_rep_rt)) +
    geom_histogram(binwidth = 0.5, data=subset(dataset,pol_party == 'democrat'),fill = "#277DA1", alpha = 0.5) +
    geom_histogram(binwidth = 0.5, data=subset(dataset,pol_party == 'republican'),fill = "#F94144", alpha = 0.5) +
  ylab("") +
  xlab("False Pro-Conservative") +
  xlim(0, 30) +
  ylim(0, 80)
p4

chart <- grid.arrange(p1, p2, p3, p4,
                      ncol = 2,
                      nrow = 2,
             top = textGrob("Mean Reading Time vs Political Affiliation for True or False headlines"),
             bottom = textGrob("Reading time"))


```
The charts above show the time spent by individuals reading headlines during the experiment. Each of its quadrants show a combination between true headlines and headline bias. One striking tendency shown by the chart are the peaks in counts for Republicans in each chart. For example, for true pro-liberal headlines, about 70 Republicans had about 2-minute reading time against about 18 Democrats in the same number of minutes. Similar trends can be found in other charts. Apparently, reading times for Democrats appear to be slightly more sparse than those for Republicans.
It is also noteworthy that peaks for Democrats appear very early in the time count for all combinations (in all, the peaks appear at about 2 minutes). For Democrats, the distribution seem to be multimodal in true pro-conservative and false pro-liberal headlines.

#### confirmation bias vs ideology
```{r}
class(dataset$ideology)

c1 <- ggplot(dataset,aes(x = ideology, y = confirmation_bias, color = ideology)) +
  geom_boxplot() +
  geom_jitter(size = 0.3)+
  scale_x_discrete(labels=c("1" = "Extremely\nliberal",
                            "2" = "",
                            "3" = "",
                            "4" = "Neutral",
                            "5" = "",
                            "6" = "",
                            "7" = "Extremely\nconservative")) +
    scale_color_manual(values = c("#277DA1",
                               "#8C9ACC",
                               "#BEA9E1",
                               "#EECDF1",
                               "#F58CAD",
                               "#FA6164",
                               "#F94144"))

c2 <- ggplot(dataset,aes(x = pol_party, y = confirmation_bias, color = pol_party)) +
  geom_boxplot() +
  geom_jitter(size = 0.3) +
  scale_x_discrete(labels=c("democrat" = "Democrat",
                            "republican" = "Republican")) +
  scale_color_manual(values=c("#277DA1",
                             "#F94144"))

grid.arrange(c1, c2,
             ncol = 2)

```
The chart shows the measure for confirmation bias (calculated as the total of concordant fact-checks minus discordant fact-checks) across ideologies and political affiliations.
The largest difference among groups observed is between Democrats and Republicans. Here, again, there is a considerable difference in median score, which is higher among Democrats. This group, however shows the lowest minimum scores -- and the highest maximum scores. The median for Republicans is close to the first quartile of Democrats, and the third quartiles for both groups are similar.
Looking at the scores across ideologies, we see that the lowest medians are located in the extremes (the two most extreme liberals and the three conservative groupings all share a median close to 0). Coincidence or not, the group with least variability is the neutral, which has a median very similar to its neighboring group of liberals.
#### Correlation between reading times
```{r}

panel.cor <- function(x, y, digits = 2, prefix = "", cex.cor, ...)
{
    par(usr = c(0, 1, 0, 1))
    r <- abs(cor(x, y))
    txt <- format(c(r, 0.123456789), digits = digits)[1]
    txt <- paste0(prefix, txt)
    if(missing(cex.cor)) cex.cor <- 0.8/strwidth(txt)
    text(0.5, 0.5, txt, cex = cex.cor * r)
}
par(mfrow = c(1, 3))
pairs(~ T_dem_rt + F_dem_rt + T_rep_rt + F_rep_rt,
    data = dataset,
    upper.panel = panel.cor,
    gap = 0,
    row1attop=TRUE,
    main = "Reading time correlation")

pairs(~ T_dem_rt + F_dem_rt + T_rep_rt + F_rep_rt,
    data = dataset,
    upper.panel = panel.cor,
    gap = 0,
    row1attop=TRUE,
    subset = pol_party == "democrat",
    main = "Reading time correlation for democrats")


pairs(~ T_dem_rt + F_dem_rt + T_rep_rt + F_rep_rt,
    data = dataset,
    upper.panel = panel.cor,
    gap = 0,
    row1attop=TRUE,
    subset = pol_party == "republican",
    main = "Reading time correlation for republicans")


```

```{r}
panel.cor <- function(x, y, digits = 2, prefix = "", cex.cor, ...)
{
    par(usr = c(0, 1, 0, 1))
    r <- abs(cor(x, y))
    txt <- format(c(r, 0.123456789), digits = digits)[1]
    txt <- paste0(prefix, txt)
    if(missing(cex.cor)) cex.cor <- 0.8/strwidth(txt)
    text(0.5, 0.5, txt, cex = cex.cor * r)
}

par(mfrow = c(3, 1))
pairs(~ t_concordant_rt + f_concordant_rt + t_discordant_rt + f_discordant_rt,
      data = dataset,
      upper.panel = panel.cor,
      gap=0,
      row1attop=TRUE,
      main = "Reading time correlation",)

pairs(~ t_concordant_rt + f_concordant_rt + t_discordant_rt + f_discordant_rt,
      data = dataset,
      row1attop=TRUE,
      subset = pol_party == "democrat",
      main = "Reading time correlation for democrats",
      upper.panel = panel.cor)

pairs(~ t_concordant_rt + f_concordant_rt + t_discordant_rt + f_discordant_rt,
      data = dataset,
      row1attop=TRUE,
      subset = pol_party == "republican",
      main = "Reading time correlation for republicans",
      upper.panel = panel.cor)


```

#### Overall reading time x Fact-checking attitude
```{r}
dataset$fact_check_att
ggplot(dataset, aes(overall_rt, fact_check_att)) +
  geom_jitter(aes (color = pol_party))
```
The chart above shows a scatter plot for overall reading time against fact-checking attitude, a measure of mean rating for three attitude toward fact-checkers questions. There is a visible concentration of observations in the top-right corner, apparently most pronounced among Republicans. In that corner are observations with low overall reading time and high fact-checking attitude. Accordingly, observations for Republicans are concentrated in the top half of the chart, whereas the ones for Democrats seem to be slightly more spread across the two halves.
It is also remarkable that there is an apparent straight line for Democrats along about 4 minutes which could not be observed in the chart above that shows a segmentation by concordance with the headlines.

#### Scatterplot reading time for concordant and discordant headlines
``` {r}
ggplot(data = dataset, aes(x = concordant_rt, y = discordant_rt)) +
  geom_point() +
  facet_grid(~ dataset$pol_party)

```

#### Ridgeline plot: AOT mean rating and correct CRT answers across ideologies
```{r}
library(ggridges)
p1 <- ggplot(dataset, aes(x = AOT, y = ideology)) +
  geom_density_ridges()
p2 <- ggplot(dataset, aes(x = CRT, y = ideology)) +
  geom_density_ridges()

p3 <- ggplot(dataset, aes(x = AOT, y = ideology)) +
  geom_density_ridges() +
  facet_wrap(~pol_party)

p4 <- ggplot(dataset, aes(x = CRT, y = ideology)) +
  geom_density_ridges() +
  facet_wrap(~pol_party)

grid.arrange(p1, p2, p3, p4,
             ncol = 2,
             nrow = 2)
```
References:
Baron, J. (2019). Actively open-minded thinking in politics. Cognition, 188, 8-18.
Frederick, S. (2005). Cognitive reflection and decision making. Journal of Economic perspectives, 19(4), 25-42.
